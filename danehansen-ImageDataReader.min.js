!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("@danehansen/math")):"function"==typeof define&&define.amd?define(["@danehansen/math"],e):"object"==typeof exports?exports.ImageDataReader=e(require("@danehansen/math")):(t.danehansen=t.danehansen||{},t.danehansen.ImageDataReader=e(t.danehansen.math))}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var s=n[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,n,i){return t[4*(i*e+n)]}function r(t,e,n,i){return t[4*(i*e+n)+1]}function h(t,e,n,i){return t[4*(i*e+n)+2]}function a(t,e,n,i){return t[4*(i*e+n)+3]}function o(t,e,n,i){return s(t,e,n,i)+h(t,e,n,i)+r(t,e,n,i)}Object.defineProperty(e,"__esModule",{value:!0}),e.brightness=e.opacity=e.blue=e.green=e.red=e.WHITE_BRIGHTNESS=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),d=n(0),c=e.WHITE_BRIGHTNESS=765;e.red=s,e.green=r,e.blue=h,e.opacity=a,e.brightness=o;var f=function(){function t(e,n,s,r){i(this,t),this._src=e,this._srcCrop=n||{x:0,y:0,width:e.videoWidth||e.width,height:e.videoHeight||e.height},this._destWidth=s||this._srcCrop.width,this._destHeight=r||this._srcCrop.height,this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("2d"),this._canvas.width=this._destWidth,this._canvas.height=this._destHeight,this.update()}return u(t,[{key:"update",value:function(){this._context.drawImage(this._src,this._srcCrop.x,this._srcCrop.y,this._srcCrop.width,this._srcCrop.height,0,0,this._destWidth,this._destHeight),this.data=this._context.getImageData(0,0,this._destWidth,this._destHeight).data}},{key:"red",value:function(t,e){return s(this.data,this._destWidth,t,e)}},{key:"green",value:function(t,e){return r(this.data,this._destWidth,t,e)}},{key:"blue",value:function(t,e){return h(this.data,this._destWidth,t,e)}},{key:"opacity",value:function(t,e){return a(this.data,this._destWidth,t,e)}},{key:"brightness",value:function(t,e){var n=o(this.data,this._destWidth,t,e);return this._shouldAdjust&&(n=Math.round((0,d.normalize)(this._low,this._high,n)*c)),n}},{key:"adjustContrast",value:function(t){if(t)this._shouldAdjust=!1;else{this._low=c,this._high=0;for(var e=0,n=this.data.length;e<n;e+=4){var i=this.data[e]+this.data[e+1]+this.data[e+2];this._high=Math.max(this._high,i),this._low=Math.min(this._low,i)}this._shouldAdjust=0!==this._low||this._high!==c,this._shouldAdjust=!0}}}]),t}();e.default=f}])});